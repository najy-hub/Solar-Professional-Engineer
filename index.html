<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="Permissions-Policy" content="browsing-topics=()">
  <title>Ù…Ù†ØµØ© Ø±Ø­Ù„Ø© Ø§Ù„Ù…Ù‡Ù†Ø¯Ø³ - Ù†Ø¸Ø§Ù… Ø§Ù„Ø¯Ø±Ø¨</title>
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
  <style>
    :root {
      --primary-color: #4361ee;
      --secondary-color: #3f37c9;
      --accent-color: #4895ef;
      --light-gray: #f8f9fa;
      --text-color: #333;
      --white: #ffffff;
      --shadow: 0 4px 20px rgba(0,0,0,0.08);
    }

    body {
      font-family: 'Cairo', sans-serif;
      background: var(--white);
      color: var(--text-color);
      margin: 0;
      padding: 0;
    }

    header, footer {
      background: var(--light-gray);
      padding: 20px;
      text-align: center;
      position: relative;
      border-bottom: 1px solid #e0e0e0;
    }

    .elegant-logout {
      background: linear-gradient(135deg, #ff6b6b, #ff8e8e);
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 25px;
      font-size: 16px;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 8px;
      box-shadow: 0 4px 6px rgba(0,0,0,0.1);
      transition: all 0.3s ease;
      position: absolute;
      left: 20px;
      top: 20px;
    }

    .elegant-logout:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 8px rgba(0,0,0,0.15);
      background: linear-gradient(135deg, #ff5252, #ff7676);
    }

    .progress-container {
      background: var(--white);
      border-radius: 16px;
      padding: 20px;
      margin: 20px auto;
      max-width: 900px;
      box-shadow: var(--shadow);
    }

    .progress-header {
      display: flex;
      justify-content: space-between;
      margin-bottom: 15px;
      font-weight: bold;
    }

    .progress-steps {
      display: flex;
      justify-content: space-between;
      position: relative;
    }

    .progress-steps::before {
      content: '';
      position: absolute;
      top: 15px;
      left: 0;
      right: 0;
      height: 4px;
      background: #eee;
      z-index: 1;
    }

    .step {
      display: flex;
      flex-direction: column;
      align-items: center;
      z-index: 2;
    }

    .step-icon {
      width: 30px;
      height: 30px;
      border-radius: 50%;
      background: #eee;
      display: flex;
      align-items: center;
      justify-content: center;
      margin-bottom: 5px;
      font-size: 14px;
    }

    .step.completed .step-icon {
      background: #4CAF50;
      color: white;
    }

    .step.current .step-icon {
      background: var(--primary-color);
      color: white;
      transform: scale(1.1);
    }

    .step-label {
      font-size: 12px;
      color: #666;
    }

    .course-sections {
      max-width: 900px;
      margin: 30px auto;
    }

    .section {
      margin-bottom: 20px;
      border-radius: 10px;
      overflow: hidden;
      box-shadow: var(--shadow);
    }

    .section-header {
      background: var(--primary-color);
      color: white;
      padding: 15px 20px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      cursor: pointer;
    }

    .section-header h2 {
      margin: 0;
    }

    .section-content {
      background: var(--white);
      padding: 15px;
      display: none;
    }

    .week-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 12px 15px;
      border-bottom: 1px solid #eee;
    }

    .week-item.unlocked {
      background: var(--light-gray);
    }

    .week-item.locked {
      opacity: 0.6;
    }

    .week-item button {
      background: var(--accent-color);
      color: white;
      border: none;
      padding: 6px 12px;
      border-radius: 5px;
      cursor: pointer;
      font-size: 14px;
    }

    .week-content {
      display: none;
      padding: 20px;
      max-width: 900px;
      margin: 0 auto;
    }

    .video-list {
      list-style: none;
      padding: 0;
    }

    .video-item {
      margin-bottom: 30px;
      background: var(--white);
      border-radius: 10px;
      padding: 15px;
      box-shadow: var(--shadow);
    }

    .video-item h4 {
      margin-bottom: 10px;
      font-size: 18px;
      color: var(--primary-color);
    }

    .bunny-video-container {
      position: relative;
      width: 100%;
      max-width: 800px;
      aspect-ratio: 16 / 9;
      border-radius: 16px;
      overflow: hidden;
      background: #000;
      display: flex;
      justify-content: center;
      align-items: center;
      margin: 20px auto;
      box-shadow: 0 8px 24px rgba(0, 0, 0, 0.2);
      border: 1px solid #eee;
      transition: transform 0.3s ease;
    }

    .bunny-video-container:hover {
      transform: scale(1.01);
    }

    .bunny-video-container iframe {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      border: none;
    }

    .quiz {
      background: var(--light-gray);
      padding: 20px;
      border-radius: 10px;
      margin-top: 20px;
    }

    .quiz a {
      color: var(--primary-color);
      text-decoration: none;
      font-weight: bold;
    }

    .quiz a:hover {
      text-decoration: underline;
    }

    .complete-btn {
      background: #4CAF50;
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 5px;
      cursor: pointer;
      font-size: 16px;
      margin-top: 10px;
      transition: all 0.3s ease;
    }

    .complete-btn:hover {
      background: #3e8e41;
      transform: translateY(-2px);
      box-shadow: 0 4px 8px rgba(0,0,0,0.1);
    }

    .week-navigation {
      text-align: center;
      margin: 30px auto;
    }

    .week-navigation button {
      background: var(--primary-color);
      color: white;
      border: none;
      padding: 12px 24px;
      border-radius: 8px;
      cursor: pointer;
      margin: 0 10px;
      font-size: 16px;
      transition: all 0.3s ease;
    }

    .week-navigation button:hover {
      background: var(--secondary-color);
      transform: translateY(-2px);
      box-shadow: 0 4px 8px rgba(0,0,0,0.1);
    }

    .lock-icon {
      color: #999;
    }

    .video-error {
      background: #ffebee;
      padding: 15px;
      border-radius: 8px;
      margin: 10px 0;
      text-align: center;
    }

    @media (max-width: 768px) {
      .progress-steps {
        flex-wrap: wrap;
        justify-content: center;
        gap: 15px;
      }
      
      .progress-steps::before {
        display: none;
      }
      
      .section-header {
        padding: 12px 15px;
      }
      
      .week-navigation button {
        width: 100%;
        margin: 10px 0;
      }
      
      .elegant-logout {
        position: static;
        margin: 10px auto;
        display: inline-flex;
      }
    }
  </style>
</head>
<body>
  <header>
    <h1>Ù…Ø±Ø­Ø¨Ø§ Ø¨Ùƒ ÙÙŠ Ø¯ÙˆØ±Ø© Ø±Ø­Ù„Ø© Ø§Ù„Ù…Ù‡Ù†Ø¯Ø³ Ø§Ù„Ù…Ø­ØªØ±Ù</h1>
    <button id="logoutBtn" class="elegant-logout">
      <i class="fas fa-sign-out-alt"></i>
      <span>ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬</span>
    </button>
  </header>

  <div class="progress-container">
    <div class="progress-header">
      <span>ØªÙ‚Ø¯Ù…Ùƒ ÙÙŠ Ø§Ù„Ø¯ÙˆØ±Ø©</span>
      <span id="progressText">0 Ù…Ù† 14 Ø£Ø³Ø§Ø¨ÙŠØ¹</span>
    </div>
    <div class="progress-steps" id="progressSteps"></div>
  </div>

  <div class="course-sections">
    <div class="section">
      <div class="section-header" onclick="toggleSection('basic')">
        <h2>Ø§Ù„Ù‚Ø³Ù… Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ (1-7)</h2>
        <i class="fas fa-chevron-down"></i>
      </div>
      <div class="section-content" id="basic-section"></div>
    </div>
    
    <div class="section">
      <div class="section-header" onclick="toggleSection('pro')">
        <h2>Ø§Ù„Ù‚Ø³Ù… Ø§Ù„Ø§Ø­ØªØ±Ø§ÙÙŠ (8-14)</h2>
        <i class="fas fa-chevron-down"></i>
      </div>
      <div class="section-content" id="pro-section"></div>
    </div>
  </div>

  <main id="weeks"></main>

  <div class="week-navigation">
    <button onclick="navigateWeek(-1)"><i class="fas fa-arrow-right"></i> Ø§Ù„Ø³Ø§Ø¨Ù‚</button>
    <button onclick="navigateWeek(1)">Ø§Ù„ØªØ§Ù„ÙŠ <i class="fas fa-arrow-left"></i></button>
  </div>

  <footer>
    Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø© &copy; 2025
  </footer>

  <!-- ØªØ­Ù…ÙŠÙ„ Ù…ÙƒØªØ¨Ø§Øª Firebase Ø¨Ø§Ù„ØªØ±ØªÙŠØ¨ Ø§Ù„ØµØ­ÙŠØ­ -->
  <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-firestore-compat.js"></script>

  <script>
// Ø£Ø¶Ù Ù‡Ø°Ø§ Ø§Ù„ÙƒÙˆØ¯ ÙÙŠ Ø¨Ø¯Ø§ÙŠØ© Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
if (window.location.search.includes('token')) {
  window.history.replaceState({}, document.title, window.location.pathname);
}
    // ØªÙƒÙˆÙŠÙ† Firebase
// ØªÙƒÙˆÙŠÙ† Firebase
const firebaseConfig = {
  apiKey: "AIzaSyBWdrUtLP4fVKHDmQDC6nUJzBMPA7AmbMc",
  authDomain: "solar-engineer-43cbc.firebaseapp.com",
  projectId: "solar-engineer-43cbc",
  storageBucket: "solar-engineer-43cbc.appspot.com",
  messagingSenderId: "816573344174",
  appId: "1:816573344174:web:b472b052d26b7be1d7003f"
};

// Ø§Ù„ØªÙ‡ÙŠØ¦Ø© Ù…Ø¹ Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø£Ø®Ø·Ø§Ø¡
let app, auth, db;

try {
  app = firebase.app();
  console.log("Using existing Firebase app");
} catch (e) {
  app = firebase.initializeApp(firebaseConfig);
  console.log("Initialized new Firebase app");
}

auth = firebase.auth();
db = firebase.firestore();

// ØªØ¹ÙŠÙŠÙ† Ø§Ø³ØªÙ…Ø±Ø§Ø±ÙŠØ© Ø§Ù„Ø¬Ù„Ø³Ø©
auth.setPersistence(firebase.auth.Auth.Persistence.LOCAL)
  .then(() => console.log("Auth persistence set to LOCAL"))
  .catch((error) => console.error("Error setting persistence:", error));
// Ø¶Ø¹ Ù‡Ø°Ø§ Ø§Ù„ÙƒÙˆØ¯ ÙÙŠ Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© Ø¨Ø¹Ø¯ Ø§Ù„ØªÙ‡ÙŠØ¦Ø©
auth.onAuthStateChanged((user) => {
  if (user) {
    console.log("User signed in:", user.uid);
    currentUser = user;
    initPage();
  } else {
    console.log("User signed out");
    window.location.href = 'https://login.najyacademia.com/';
  }
});
    // Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¯ÙˆØ±Ø©
    const courseData = {
      weeks: [
        null, // Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ 0 ØºÙŠØ± Ù…Ø³ØªØ®Ø¯Ù…
        { // Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ 1
          videos: [
            { title: "ğŸ“˜ Lec1: Principle of Operation", url: "https://iframe.mediadelivery.net/embed/460802/dce4ee28-5099-44df-9760-dddcf3609a95?autoplay=0" },
            { title: "ğŸ“˜ Lec2: Solar Technology", url: "https://iframe.mediadelivery.net/embed/460802/5c9229c6-4dc8-45cf-9b71-e6e4fce12da6?autoplay=0" },
            { title: "ğŸ“˜ Lec3: Area & Efficiency", url: "https://iframe.mediadelivery.net/embed/460802/7082d1ef-61a6-4ee4-82c0-ced096b8188f?autoplay=0" },
            { title: "ğŸ“˜ Lec4: Data sheet and Nameplate", url: "https://iframe.mediadelivery.net/embed/460802/4b7a1509-496d-4d39-ba3c-d635198fa551?autoplay=0" },
            { title: "ğŸ“˜ Lec5: Strategy Of Select Pv Panels", url: "https://iframe.mediadelivery.net/embed/460802/cfe04177-caf9-4e6c-a873-9691897b0fc8?autoplay=0" }
          ],
          quiz: "https://najy-hub.github.io/Assignment1/"
        },
        { // Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ 2
          videos: [
            { title: "ğŸ“˜ Lec1: Behaviour of Electron", url: "https://iframe.mediadelivery.net/embed/460802/96a7baa2-15e4-46af-b385-a5ffdfa2e9be?autoplay=0" },
            { title: "ğŸ“˜ Lec2: Energy Bands", url: "https://iframe.mediadelivery.net/embed/460802/66b5260c-5552-4a88-8abb-69defa6ac944?autoplay=0" },
            { title: "ğŸ“˜ Lec3: Electron Journey1", url: "https://iframe.mediadelivery.net/embed/460802/747b6fb2-bc35-4b71-929c-fb16e82806c8?autoplay=0" },
            { title: "ğŸ“˜ Lec4: Electron Journey2", url: "https://iframe.mediadelivery.net/embed/460802/93af94fd-39b6-4527-9cac-5ca25bc6cd89?autoplay=0" }
          ],
          quiz: "https://najy-hub.github.io/Assignment2/"
        }
        // ÙŠÙ…ÙƒÙ† Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø£Ø³Ø§Ø¨ÙŠØ¹ Ù…Ù† 3 Ø¥Ù„Ù‰ 14 Ù‡Ù†Ø§
      ]
    };

    // Ø§Ù„Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ø¹Ø§Ù…Ø©
    let currentUser = null;
    let currentWeek = 1;
    let unlockedWeeks = [1];
    let completedWeeks = [];

    // Ø¯Ø§Ù„Ø© ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
    async function loadUserData() {
  try {
    console.log("Loading data for user:", currentUser.uid);
    const userDoc = await db.collection('trainees').doc(currentUser.uid).get();
    
    if (!userDoc.exists) {
      console.log("No user document, creating new one");
      await db.collection('trainees').doc(currentUser.uid).set({
        dripStartDate: new Date().toISOString(),
        unlockedWeeks: [1],
        completedWeeks: [],
        currentWeek: 1
      });
    } else {
      const userData = userDoc.data();
      console.log("User data loaded:", userData);
      unlockedWeeks = userData.unlockedWeeks || [1];
      completedWeeks = userData.completedWeeks || [];
      currentWeek = userData.currentWeek || 1;
    }
  } catch (error) {
    console.error("Error loading user data:", error);
    alert("Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…");
  }
}
// Ø§Ø¶ÙØª Ø¯Ø§Ù„Ø© Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª 
    async function saveUserData() {
  try {
    await db.collection('trainees').doc(currentUser.uid).update({
      unlockedWeeks: unlockedWeeks,
      completedWeeks: completedWeeks,
      currentWeek: currentWeek,
      lastUpdated: new Date().toISOString()
    });
    console.log("User data saved successfully");
  } catch (error) {
    console.error("Error saving user data:", error);
  }
}
    // Ø¯Ø§Ù„Ø© Ø­ÙØ¸ Ø§Ù„ØªÙ‚Ø¯Ù…
    async function saveProgress() {
      try {
        await db.collection('trainees').doc(currentUser.uid).update({
          unlockedWeeks: unlockedWeeks,
          completedWeeks: completedWeeks,
          currentWeek: currentWeek,
          lastActive: new Date().toISOString()
        });
      } catch (error) {
        console.error("Error saving progress:", error);
      }
    }
//ÙƒÙˆØ¯ Ø¶ÙØªÙ‡ Ø§Ù†Ø§ Ù„Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø§Ø®Ø·Ø§Ø¡ ÙŠÙˆÙ… Ø§Ù„Ø§Ø­Ø¯
auth.onAuthStateChanged(async (user) => {
  if (user) {
    console.log("User signed in:", user.uid);
    currentUser = user;
    await loadUserData();
    
    // ØªØ£ÙƒØ¯ Ù…Ù† Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£ÙˆÙ„ÙŠØ©
    if (!(await db.collection('trainees').doc(user.uid).get()).exists) {
      await saveUserData();
    }
    
    initPage();
  } else {
    console.log("No user signed in");
    window.location.href = 'https://login.najyacademia.com/';
  }
});
    // Ø£Ø¶Ù Ù‡Ø°Ù‡ Ø§Ù„Ø¯Ø§Ù„Ø© ÙÙŠ Ù…ÙƒØ§Ù† ÙˆØ§Ø¶Ø­ ÙÙŠ Ø§Ù„ÙƒÙˆØ¯
function toggleSection(sectionId) {
  const section = document.getElementById(`${sectionId}-section`);
  const icon = section.previousElementSibling.querySelector('i');
  
  if (section.style.display === 'block') {
    section.style.display = 'none';
    icon.classList.replace('fa-chevron-up', 'fa-chevron-down');
  } else {
    section.style.display = 'block';
    icon.classList.replace('fa-chevron-down', 'fa-chevron-up');
  }
}
    // Ø¯Ø§Ù„Ø© ØªØ¨Ø¯ÙŠÙ„ Ø§Ù„Ø£Ù‚Ø³Ø§Ù…
    function toggleSection(sectionId) {
      const section = document.getElementById(`${sectionId}-section`);
      const icon = section.previousElementSibling.querySelector('i');
      
      if (section.style.display === 'block') {
        section.style.display = 'none';
        icon.classList.replace('fa-chevron-up', 'fa-chevron-down');
      } else {
        section.style.display = 'block';
        icon.classList.replace('fa-chevron-down', 'fa-chevron-up');
      }
    }

    // Ø¯Ø§Ù„Ø© Ø§Ù„ØªÙ†Ù‚Ù„ Ø¨ÙŠÙ† Ø§Ù„Ø£Ø³Ø§Ø¨ÙŠØ¹
    function navigateWeek(step) {
      const newWeek = currentWeek + step;
      if (newWeek >= 1 && newWeek <= 14) {
        loadWeek(newWeek);
      }
    }

    // Ø¯Ø§Ù„Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬
    function logout() {
      auth.signOut().then(() => {
        window.location.href = 'https://najy-hub.github.io/Login-Course/';
      });
    }
// Ø¥Ø¶Ø§ÙØ© Ø¯Ø§Ù„Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¨Ø¹Ø¯ Ø§Ù„Ø®Ø±ÙˆØ¬
   async function handleLogin(email, password) {
  try {
    // ØªØ£ÙƒØ¯ Ù…Ù† ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ø§Ø³ØªÙ…Ø±Ø§Ø±ÙŠØ© Ù‚Ø¨Ù„ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
    await auth.setPersistence(firebase.auth.Auth.Persistence.LOCAL);
    
    const userCredential = await auth.signInWithEmailAndPassword(email, password);
    currentUser = userCredential.user;
    
    // Ø­ÙØ¸ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø£ÙˆÙ„ÙŠØ©
    await initializeUserData();
    
    // ØªØ£Ø®ÙŠØ± Ø§Ù„ØªÙˆØ¬ÙŠÙ‡ Ù„Ø¶Ù…Ø§Ù† Ø­ÙØ¸ Ø§Ù„Ø­Ø§Ù„Ø©
    setTimeout(() => {
      window.location.href = "/dashboard"; // ØºÙŠØ± Ø§Ù„Ù…Ø³Ø§Ø± Ø­Ø³Ø¨ Ø­Ø§Ø¬ØªÙƒ
    }, 500);
    
    return true;
  } catch (error) {
    console.error("Login error:", error);
    alert(`ÙØ´Ù„ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„: ${error.message}`);
    return false;
  }
}
    // Ø£Ø¶Ù Ù‡Ø°Ø§ ÙÙŠ ØµÙØ­Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬
async function logout() {
  try {
    await auth.signOut();
    window.location.href = 'https://login.najyacademia.com/';
  } catch (error) {
    console.error("Logout error:", error);
  }
}
window.localStorage.clear();
window.sessionStorage.clear();
if (window.indexedDB) {
  indexedDB.deleteDatabase("firebaseLocalStorageDb");
}
    // Ø¯Ø§Ù„Ø© Ø¹Ø±Ø¶ Ø§Ù„ØªÙ‚Ø¯Ù…
    function renderProgress() {
      const progressText = document.getElementById('progressText');
      const progressSteps = document.getElementById('progressSteps');
      
      progressText.textContent = `${completedWeeks.length} Ù…Ù† 14 Ø£Ø³Ø§Ø¨ÙŠØ¹`;
      
      progressSteps.innerHTML = '';
      for (let i = 1; i <= 14; i++) {
        const step = document.createElement('div');
        step.className = `step ${completedWeeks.includes(i) ? 'completed' : ''} ${i === currentWeek ? 'current' : ''}`;
        step.innerHTML = `
          <div class="step-icon">${completedWeeks.includes(i) ? 'âœ“' : i}</div>
          <div class="step-label">Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ ${i}</div>
        `;
        progressSteps.appendChild(step);
      }
    }

    // Ø¯Ø§Ù„Ø© Ø¹Ø±Ø¶ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø£Ø³Ø§Ø¨ÙŠØ¹
    function renderWeekList() {
      const basicSection = document.getElementById('basic-section');
      const proSection = document.getElementById('pro-section');
      
      basicSection.innerHTML = '';
      proSection.innerHTML = '';
      
      for (let i = 1; i <= 14; i++) {
        const weekItem = document.createElement('div');
        weekItem.className = `week-item ${unlockedWeeks.includes(i) ? 'unlocked' : 'locked'}`;
        weekItem.innerHTML = `
          <span>Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ ${i}</span>
          ${unlockedWeeks.includes(i) ? 
            `<button onclick="loadWeek(${i})">ÙØªØ­</button>` : 
            `<span class="lock-icon">ğŸ”’</span>`}
        `;
        
        if (i <= 7) {
          basicSection.appendChild(weekItem);
        } else {
          proSection.appendChild(weekItem);
        }
      }
    }

    // Ø¯Ø§Ù„Ø© Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØµØ­Ø© Ø§Ù„Ø±Ø§Ø¨Ø·
    function isValidUrl(url) {
      try {
        new URL(url);
        return true;
      } catch {
        return false;
      }
    }
// Ø£Ø¶Ù Ù‡Ø°Ø§ ÙÙŠ Ø£ÙŠ Ù…ÙƒØ§Ù† ÙÙŠ Ø§Ù„ÙƒÙˆØ¯
db.enablePersistence()
  .then(() => console.log("Offline persistence enabled"))
  .catch((err) => {
    if (err.code == 'failed-precondition') {
      console.log("Persistence can only be enabled in one tab at a time");
    } else if (err.code == 'unimplemented') {
      console.log("The current browser does not support offline persistence");
    }
  });
    // Ø¯Ø§Ù„Ø© ØªØ­Ù…ÙŠÙ„ Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹
    async function loadWeek(weekNumber) {
      if (!unlockedWeeks.includes(weekNumber)) {
        alert('Ù‡Ø°Ø§ Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ ØºÙŠØ± Ù…ØªØ§Ø­ Ù„Ùƒ Ø¨Ø¹Ø¯');
        return;
      }
      
      currentWeek = weekNumber;
      await saveProgress();
      
      const weekData = courseData.weeks[weekNumber];
      const weeksContainer = document.getElementById('weeks');
      
      weeksContainer.innerHTML = '';
      
      if (!weekData) {
        weeksContainer.innerHTML = '<p>Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ù‚ÙŠØ¯ Ø§Ù„ØªØ¬Ù‡ÙŠØ²</p>';
        return;
      }
      
      const weekDiv = document.createElement('div');
      weekDiv.className = 'week-content';
      weekDiv.style.display = 'block';
      
      const title = document.createElement('h2');
      title.textContent = `Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ ${weekNumber} - ${weekNumber <= 7 ? 'Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ' : 'Ø§Ù„Ø§Ø­ØªØ±Ø§ÙÙŠ'}`;
      weekDiv.appendChild(title);
      
      const videoList = document.createElement('ul');
      videoList.className = 'video-list';
      
      if (weekData.videos && weekData.videos.length > 0) {
        weekData.videos.forEach(video => {
          const videoItem = document.createElement('li');
          videoItem.className = 'video-item';
          
          if (isValidUrl(video.url)) {
            videoItem.innerHTML = `
              <h4>${video.title}</h4>
              <div class="bunny-video-container">
                <iframe src="${encodeURI(video.url)}" 
                        allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
                        allowfullscreen
                        loading="lazy"></iframe>
              </div>
            `;
          } else {
            videoItem.innerHTML = `
              <h4>${video.title}</h4>
              <div class="video-error">
                <p>Ø¹Ø°Ø±Ø§Ù‹ØŒ Ù„Ø§ ÙŠÙ…ÙƒÙ† ØªØ­Ù…ÙŠÙ„ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ Ø­Ø§Ù„ÙŠØ§Ù‹</p>
                <a href="${video.url}" target="_blank">Ø¬Ø±Ø¨ ÙØªØ­ Ø§Ù„Ø±Ø§Ø¨Ø· ÙÙŠ Ù†Ø§ÙØ°Ø© Ø¬Ø¯ÙŠØ¯Ø©</a>
              </div>
            `;
          }
          
          videoList.appendChild(videoItem);
        });
      } else {
        videoList.innerHTML = '<p>Ù„Ø§ ØªÙˆØ¬Ø¯ ÙÙŠØ¯ÙŠÙˆÙ‡Ø§Øª Ù…ØªØ§Ø­Ø© Ù„Ù‡Ø°Ø§ Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹</p>';
      }
      
      weekDiv.appendChild(videoList);
      
      if (weekData.quiz) {
        const quizDiv = document.createElement('div');
        quizDiv.className = 'quiz';
        quizDiv.innerHTML = `
          <h3>ğŸ“ Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹</h3>
          <p><a href="${weekData.quiz}" target="_blank">Ø±Ø§Ø¨Ø· Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±</a></p>
          <button onclick="completeWeek(${weekNumber})" class="complete-btn">ØªÙ… Ø§Ù„Ø§Ù†ØªÙ‡Ø§Ø¡ Ù…Ù† Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹</button>
        `;
        weekDiv.appendChild(quizDiv);
      }
      
      weeksContainer.appendChild(weekDiv);
      renderProgress();
    }

    // Ø¯Ø§Ù„Ø© Ø¥ÙƒÙ…Ø§Ù„ Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹
    async function completeWeek(weekNumber) {
      if (!completedWeeks.includes(weekNumber)) {
        completedWeeks.push(weekNumber);
        
        // ÙØªØ­ Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø§Ù„ØªØ§Ù„ÙŠ Ø¥Ø°Ø§ ÙƒØ§Ù† Ù…ÙˆØ¬ÙˆØ¯Ø§Ù‹
        const nextWeek = weekNumber + 1;
        if (nextWeek <= 14 && !unlockedWeeks.includes(nextWeek)) {
          unlockedWeeks.push(nextWeek);
        }
        
        await saveProgress();
        renderProgress();
        renderWeekList();
        alert(`ØªÙ‡Ø§Ù†ÙŠÙ†Ø§! Ù„Ù‚Ø¯ Ø£ÙƒÙ…Ù„Øª Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ ${weekNumber}`);
      }
    }

    // Ø¯Ø§Ù„Ø© ØªÙ‡ÙŠØ¦Ø© Ø§Ù„ØµÙØ­Ø©
    function initPage() {
      renderProgress();
      renderWeekList();
      loadWeek(currentWeek);
    }

    // Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©
    document.addEventListener('DOMContentLoaded', () => {
      auth.onAuthStateChanged(async (user) => {
        if (user) {
          currentUser = user;
          await loadUserData();
          initPage();
        } else {
          window.location.href = 'https://login.najyacademia.com/';
        }
      });

      document.getElementById('logoutBtn').addEventListener('click', logout);
      
      // ÙØªØ­ Ø§Ù„Ù‚Ø³Ù… Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ø¹Ù†Ø¯ Ø§Ù„ØªØ­Ù…ÙŠÙ„
      document.getElementById('basic-section').style.display = 'block';
      document.querySelector('.section-header i').classList.replace('fa-chevron-down', 'fa-chevron-up');
    });
  </script>
</body>
</html>
